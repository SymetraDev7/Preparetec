<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>CADASTRO - PREPARETEC</title>

    <link
      rel="stylesheet"
      type="text/css"
      href="./../assets/styles/style.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap"
      rel="stylesheet"
    />

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>
  </head>

  <body>
    <header class="header-cadastro">
      <a href="index.html">
        <article class="left-upper"></article>
      </a>
      <article class="right-upper">
        <a href="https://mongagua.sp.gov.br/educacao">
          <aside class="logo-dem"></aside>
        </a>
        <a href="https://mongagua.sp.gov.br/">
          <aside class="logo-prefeitura"></aside>
        </a>
      </article>
    </header>
    <main class="main-cadastro">
      <form class="form-cadastro">
        <h2>CADASTRO</h2>
        <div class="group-form">
          <label>Selecione o tipo de usuário:</label>
          <select name="tipo-usuario" id="tipoUsuario">
            <option value="administrador">Administrador</option>
            <option value="professor">Professor</option>
            <option value="aluno">Aluno</option>
          </select>
          <label>Insira o nome do usuário: </label>
          <input
            class="input-cadastro"
            type="text"
            id="nome"
            autocomplete="off"
          />
          <label>Insira o e-mail: </label>
          <input class="input-cadastro" type="text" id="email" />
          <label>Insira o telefone (somente números):</label>
          <input
            class="input-cadastro"
            type="text"
            id="telefone"
            placeholder="(__) _____-____"
            data-mask="(00) 00000-0000"
            maxlength="15"
            autocomplete="off"
          />
          <label>Insira Uma Senha:</label>
          <input
            class="input-cadastro"
            type="password"
            id="senha"
            maxlength="8"
            autocomplete="off"
          />
          <div class="group-professores">
            <label>CPF do Professor: </label>
            <input
              class="input-cadastro"
              type="text"
              name="cpfProfessor"
              id="cpfProfessor"
              placeholder="___.___.___-__"
              data-mask="000.000.000-00"
              maxlength="14"
              autocomplete="off"
            />
            <label>CEP do Professor: </label>
            <input
              class="input-cadastro"
              type="text"
              id="cepProfessor"
              name="cepProfessor"
              placeholder="_____-___"
              data-mask="00000-000"
              maxlength="9"
              autocomplete="off"
            />
            <label>Insira o endereço: </label>
            <input
              class="input-cadastro"
              type="text"
              name="enderecoProfessor"
              id="enderecoProfessor"
            />
            <label>Formação do Professor: </label>
            <input
              class="input-cadastro"
              type="text"
              name="formacaoProfessor"
              id="formacaoProfessor"
            />
            <label>Disciplina do Professor: </label>
            <input
              class="input-cadastro"
              type="text"
              id="disciplinaProfessor"
              name="disciplinaProfessor"
            />
            <label>Polos que vai dar aula: </label>
            <select name="poloProfessor" id="poloProfessor">
              <option value="Sirana">Sirana</option>
              <option value="Jacoub">Jacoub</option>
            </select>
          </div>
          <div class="group-alunos">
            <label>CPF do Aluno: </label>
            <input
              class="input-cadastro"
              type="text"
              id="cpfAluno"
              name="cpfAluno"
              placeholder="___.___.___-__"
              data-mask="000.000.000-00"
              maxlength="14"
              autocomplete="off"
            />
            <label>Data de Nascimento do Aluno: </label>
            <input
              class="input-cadastro"
              type="text"
              id="dtNasc"
              name="dtNasc"
              placeholder="DD/MM/AAAA"
              data-mask="00/00/0000"
              maxlength="10"
              autocomplete="off"
            />
            <label>Escola: </label>
            <input
              class="input-cadastro"
              type="text"
              id="escolaAluno"
              name="escolaAluno"
              maxlength="100"
              autocomplete="off"
            />
            <label>RA: </label>
            <input
              class="input-cadastro"
              type="text"
              id="raAluno"
              name="raAluno"
              maxlength="10"
              autocomplete="off"
            />
            <label>Insira o endereço: </label>
            <input
              class="input-cadastro"
              type="text"
              id="enderecoAluno"
              name="enderecoAluno"
              name="enderecoAluno"
              autocomplete="off"
            />
            <label>Polo que vai estudar: </label>
            <select name="poloAluno" id="poloAluno">
              <option value="Sirana">Sirana</option>
              <option value="Jacoub">Jacoub</option>
            </select>
          </div>
          <button id="signup-btn-submit" class="button-submit">
            <label>Cadastrar</label>
          </button>
        </div>
      </form>
    </main>
    <!-- <script src="../assets/styles/style.js"></script> -->
    <!-- <script src="../assets/src/index.js"></script> -->
    <script>
      var formProfessores = document.querySelector(".group-professores");
      var formAlunos = document.querySelector(".group-alunos");
      var tipoUsuario = document.querySelector("#tipoUsuario");

      const form = {
        nome: document.querySelector("#nome"),
        email: document.querySelector("#email"),
        telefone: document.querySelector("#telefone"),
        cpfProfessor: document.querySelector("#cpfProfessor"),
        cepProfessor: document.querySelector("#cepProfessor"),
        enderecoProfessor: document.querySelector("#enderecoProfessor"),
        formacaoProfessor: document.querySelector("#formacaoProfessor"),
        disciplinaProfessor: document.querySelector("#disciplinaProfessor"),
        poloProfessor: document.querySelector("#poloProfessor"),
        cpfAluno: document.querySelector("#cpfAluno"),
        dtNasc: document.querySelector("#dtNasc"),
        enderecoAluno: document.querySelector("#enderecoAluno"),
        poloAluno: document.querySelector("#poloAluno"),
        raAluno: document.querySelector("#raAluno"),
        escolaAluno: document.querySelector("#escolaAluno"),
        senha: document.querySelector("#senha"),
        submit: document.querySelector("#signup-btn-submit"),
      };

      function clean() {
        form.nome.value = "";
        form.email.value = "";
        form.telefone.value = "";
        form.cpfProfessor.value = "";
        form.cepProfessor.value = "";
        form.enderecoProfessor.value = "";
        form.formacaoProfessor.value = "";
        form.disciplinaProfessor.value = "";
        form.cpfAluno.value = "";
        form.dtNasc.value = "";
        form.enderecoAluno.value = "";
        form.raAluno.value = "";
        form.escolaAluno.value = "";
        form.senha.value = "";
      }

      tipoUsuario.addEventListener("change", (e) => {
        if (tipoUsuario.value === "professor") {
          formProfessores.style.display = "flex";
          formAlunos.style.display = "none";
          clean();
          let button = form.submit.addEventListener("click", (e) => {
            let url = "http://localhost:3333/api/admin/professores";
            e.preventDefault();
            fetch(url, {
              method: "POST",
              headers: {
                Accept: "application/json, text/plain, */*",
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                nome: form.nome.value,
                cpf: form.cpfProfessor.value,
                email: form.email.value,
                tel: form.telefone.value,
                formacao: form.formacaoProfessor.value,
                end:
                  form.cepProfessor.value + " " + form.enderecoProfessor.value,
                disc: form.disciplinaProfessor.value,
                senha: form.senha.value,
              }),
            })
              .then((response) => response.json())
              .then((res) => {
                if (res.code === 200) {
                  alert("Professor Cadastrado Com Sucesso!");
                } else if (res.code === 500) {
                  alert("Professor Já Foi Cadastrado!");
                } else {
                  ("Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com");
                }
              })
              .catch((error) => {
                console.log(
                  "Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com"
                );
              });
          });
          function verificar() {}
        } else if (tipoUsuario.value === "aluno") {
          formAlunos.style.display = "flex";
          formProfessores.style.display = "none";
          clean();
          let button = form.submit.addEventListener("click", (e) => {
            let url = "http://localhost:3333/api/admin/alunos";
            e.preventDefault();
            fetch(url, {
              method: "POST",
              headers: {
                Accept: "application/json, text/plain, */*",
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                nome: form.nome.value,
                cpf: form.cpfAluno.value,
                dataNasc: form.dtNasc.value,
                end: form.enderecoAluno.value,
                escola: form.escolaAluno.value,
                email: form.email.value,
                telResp: form.telefone.value,
                polo: form.poloAluno.value,
                ra: form.raAluno.value,
                senha: form.senha.value,
              }),
            })
              .then((response) => response.json())
              .then((res) => {
                if (res.code === 200) {
                  alert("Aluno  Cadastrado Com Sucesso!");
                } else if (res.code === 500) {
                  alert("Aluno  Já Foi Cadastrado!");
                } else {
                  ("Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com");
                }
              })
              .catch((error) => {
                console.log(
                  "Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com"
                );
              });
          });
        } else if (tipoUsuario.value === "administrador") {
          formProfessores.style.display = "none";
          formAlunos.style.display = "none";
          clean();
          let button = form.submit.addEventListener("click", (e) => {
            let url = "http://localhost:3333/api/admin/admin";
            e.preventDefault();
            fetch(url, {
              method: "POST",
              headers: {
                Accept: "application/json, text/plain, */*",
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                nome: form.nome.value,
                email: form.email.value,
                tel: form.telefone.value,
                senha: form.senha.value,
              }),
            })
              .then((response) => response.json())
              .then((res) => {
                console.log(res);
                if (res.code === 200) {
                  alert("Usuario Cadastrado Com Sucesso!");
                } else if (res.code === 500) {
                  alert("Usuario Já Foi Cadastrado!");
                } else {
                  ("Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com");
                }
              })
              .catch((error) => {
                console.log(
                  "Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com"
                );
              });
          });
        } else {
          alert(
            "Parece Que ocorreu um erro, tente recarregar a pagina se o erro persistir entre em contato com o suporte técnico através do email: symetraStack@gmail.com"
          );
        }
      });
    </script>
  </body>
</html>
